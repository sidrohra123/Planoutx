<ion-content>
  <div class="maincontent">
    <div class="orderDetails" *ngIf="order">
      <div class="whiteCard">
        <h3>Recipient Details</h3>
        <p>{{ order.delivery_name }}</p>
        <p>{{ order.delivery_street_address }}</p>
        <p>{{ order.delivery_city }}, {{ order.delivery_postcode }}</p>
        <p>Mobile: {{ order.customers_telephone }}</p>
      </div>
      <div class="whiteCard">
        <h3>Products</h3>
        <div class="orderBody" *ngFor="let prod of order.data">
          <div class="imageOrder">
            <img [src]="data.apiUrlNew+prod.image" />
          </div>
          <div class="prodDetails">
            <p>{{ prod.products_name }} </p>
            <p><strong>Price:</strong> <span>₹ {{ prod.final_price }} X {{ prod.products_quantity }}</span></p>
          </div>
          <div class="productActions">
            <ion-button expand="block" (click)="cancelProductFromOrder(prod)" color="tertiary" fill="outline" size="small" *ngIf="order.orders_status=='Pending' && prod.categories_id == '2'">Cancel</ion-button>
            <ion-button color="tertiary" fill="outline" size="small" (click)="returnProductFromOrder(prod)" *ngIf="isEligibleForReturn && order.orders_status=='Completed'">Return</ion-button>
            <p *ngIf="order.orders_status=='Completed' && orderDay && orderDay > 0">Days left till return period : {{ maxReturnPeriod - orderDay }}</p>
          </div>
        </div>
      </div>
      <div class="whiteCard">
        <h3 style="margin-bottom:5px;">Price Details</h3>
        <p><strong>Subtotal:</strong><span>₹ {{ (+order.order_price - +order.shipping_cost).toFixed(2) }}</span></p>
        <p><strong>Discount:</strong><span>₹ {{ (+order.coupon_amount).toFixed(2) }}</span></p>
        <p><strong>Shipping:</strong><span>₹ {{ order.shipping_cost }}</span></p>
        <p><strong><b>Total:</b></strong><span style="text-align:right"><b>₹ {{ order.order_price }}</b><small style="display:block">(Inc. of all Taxes)</small></span></p>
      </div>
      <div class="whiteCard orderStatus">
        <h3 style="margin-bottom:5px;">Order Status</h3>
        <p><strong>Order placed on:</strong><span> {{ order.date_purchased | date:'dd MMM yyyy' }}</span></p>
        <p><strong>Current Status:</strong><span> {{ order.orders_status == 'Pending' ? 'Order Placed' : order.orders_status == 'Delivered' ? 'Delivered on '+(order.last_modified | date:'dd MMM yyyy') : order.orders_status }}</span></p>
      </div>
      <div class="actions">
        <ion-button expand="block" color="tertiary" (click)="openRaiseQueryForm()">Raise Query</ion-button>
      </div>
      <span class="popupOverlay" (click)="closeQueryForm()" *ngIf="isFormOpened"></span>
      <div class="formQuery" *ngIf="isFormOpened">
        <h3>Tell us what your query is about <span (click)="closeQueryForm()">&times;</span></h3>
        <div class="form">
          <label>Your Name</label>
          <input type="text" placeholder="Enter your name" [(ngModel)]="query.name" />
          <label>Your Email Id</label>
          <input type="text" placeholder="Enter your email id" [(ngModel)]="query.email" />
          <label>Describe your Query</label>
          <textarea [(ngModel)]="query.feedback" placeholder="Enter your query here" rows="10"></textarea>
          <div class="buttonSubmits" (click)="sendQuery()">
            <ion-button expand="block" color="tertiary">Submit Query</ion-button>
          </div>
        </div>
      </div>
    </div>
  </div>
</ion-content>